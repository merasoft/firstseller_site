<p-popover #menu (onHide)="isMenuOpen = false">
  <div class="flex">
    <ul *ngIf="!isLoading && catalogData">
      <li
        *ngFor="let category of catalogData.categories"
        (mouseenter)="setActiveCategory(category)"
        class="relative hover:bg-gray-100 border-b last:border-b-0 border-b-gray-200 border-l-2 border-l-transparent py-2 px-4 cursor-pointer"
        [ngClass]="{ '!border-l-primary-500 ': activeCategory?.id === category.id }">
        <button class="w-full text-left transition-all duration-200 flex items-center justify-between gap-3">
          <div class="flex items-center gap-3">
            <i [class]="category.icon" class="text-lg"></i>
            <span class="font-medium">{{ category.name }}</span>
          </div>
          <i class="pi pi-angle-right text-sm"></i>
        </button>
      </li>
    </ul>

    <div *ngIf="activeCategory" class="p-8 border-l border-l-gray-200">
      <!-- Category Header -->
      <div class="mb-8">
        <h2 class="text-2xl font-bold text-gray-900 mb-2">{{ activeCategory.name }}</h2>
        <p class="text-gray-600">Ознакомьтесь с нашим широким ассортиментом продукции {{ activeCategory.name.toLowerCase() }}</p>
      </div>

      <div class="grid grid-cols-4 gap-8">
        <!-- Subcategories Column -->
        <div class="col-span-2">
          <h4 class="text-lg font-semibold text-gray-900 mb-4">Покупать по категориям</h4>
          <div class="grid grid-cols-2 gap-3">
            <a
              *ngFor="let subcategory of activeCategory.subcategories"
              [routerLink]="['/catalog', subcategory.slug]"
              class="flex items-center justify-between gap-3 p-3 rounded-lg transition-colors group border border-gray-100 hover:border-primary-200">
              <span class="text-gray-700 group-hover:text-primary-700 font-medium text-sm">
                {{ subcategory.name }}
              </span>
              <span class="w-7 h-7 flex items-center justify-center text-xs font-bold text-gray-700 bg-gray-100 group-hover:bg-green-600 group-hover:text-white rounded-full">
                {{ subcategory.count }}
              </span>
            </a>
          </div>
        </div>
      </div>

      <!-- Bottom Banner -->
      <div class="mt-8 p-6 bg-gradient-to-r from-primary-50 to-primary-100 rounded-2xl">
        <div class="flex items-center justify-between">
          <div>
            <h3 class="text-xl font-bold text-gray-900 mb-2">Специальные предложения</h3>
            <p class="text-gray-600">Получите скидку до 30% на избранные товары</p>
          </div>
          <button (click)="viewAllCategory(activeCategory)" class="bg-primary-500 text-white px-6 py-3 rounded-xl hover:bg-primary-600 transition-colors font-semibold"> Все товары </button>
        </div>
      </div>
    </div>
  </div>
</p-popover>
