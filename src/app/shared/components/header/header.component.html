<!-- src/app/shared/components/header/header.component.html -->
<header class="header relative z-50">
  <!-- Top Bar -->
  <div class="topbar bg-green-500 text-white text-sm py-2">
    <div class="max-w-screen-2xl mx-auto px-4 sm:px-6 lg:px-8 flex justify-between">
      <div> Товары из первых рук (оптом) </div>

      <div class="flex items-center justify-center gap-8">
        <div class="flex items-center gap-2">
          <i class="pi pi-phone"></i>
          <span>+998 71 203 00 00</span>
        </div>

        <div class="hidden md:flex items-center gap-2">
          <i class="pi pi-truck"></i>
          <span>Тез етказиб бериш барча вилоятларга</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Main Header -->
  <div class="top-menu bg-white shadow-sm border-b border-gray-200">
    <div class="max-w-screen-2xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="action-wrapper flex items-center justify-between h-16">
        <!-- Ham menu -->
        <button (click)="toggleMenu()" class="hamburger-menu hidden text-primary-700">
          <i class="pi pi-bars text-2xl"></i>
        </button>

        <div class="logo-wrapper flex-1 flex items-center">
          <!-- Logo -->
          <button (click)="onLogoClick()" class="h-[50px]">
            <img src="/assets/images/logo_green.png" alt="Logo" class="w-full h-full object-cover" />
          </button>

          <!-- Search Bar -->
          <div class="searchbar flex-1 max-w-2xl mx-8">
            <div class="relative">
              <input pInputText type="text" [(ngModel)]="searchQuery" (keyup.enter)="onSearch()" placeholder="Маҳсулотларни излаш..." class="form-search pl-4 py-3 pr-[120px]" />
              <p-button (onClick)="onSearch()" icon="pi pi-search text-sm" label="Поиск" styleClass="bg-primary-300 px-3 py-1 rounded-lg absolute right-2 top-1/2 transform -translate-y-1/2" />
            </div>
          </div>
        </div>

        <!-- User Actions -->
        <div class="flex items-center gap-6">
          <ng-container *ngFor="let action of userActions">
            <button *ngIf="action.main" (click)="onUserActionClick(action)" class="flex flex-col items-center gap-1 transition-colors group action-{{ action.name }}">
              <!-- Icon -->
              <div *ngIf="action.type == 'icon'" class="relative">
                <i class="{{ action.url }} text-lg text-gray-700 group-hover:text-primary-700"></i>
                <span *ngIf="action.count > 0" class="w-5 h-5 absolute -top-1 -right-3 bg-red-500 text-white text-xs rounded-full flex items-center justify-center">
                  {{ action.count }}
                </span>
              </div>

              <!-- Image -->
              <div *ngIf="action.type == 'image'" class="relative mb-1">
                <img [src]="action.url" alt="{{ action.title }}" class="w-6 h-6 object-cover" />
                <span *ngIf="action.count > 0" class="w-5 h-5 absolute -top-1 -right-3 bg-red-500 text-white text-xs rounded-full flex items-center justify-center">
                  {{ action.count }}
                </span>
              </div>

              <!-- Title -->
              <span class="text-xs text-gray-700 group-hover:text-primary-700">{{ action.title }}</span>
            </button>
          </ng-container>
        </div>
      </div>
    </div>
  </div>

  <div class="searchbar-mobile hidden px-4 sm:px-6 lg:px-8 mt-4">
    <input
      pInputText
      type="text"
      [(ngModel)]="searchQuery"
      (keyup.enter)="onSearch()"
      placeholder="Маҳсулотларни излаш..."
      class="form-search text-sm sm:text-base bg-white px-2 sm:px-4 py-2 !rounded-lg" />
  </div>

  <!-- Navigation Menu -->
  <div class="secondary-menu bg-white border-b border-gray-200 relative">
    <div class="max-w-screen-2xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex items-center justify-between">
        <!-- Main Navigation -->
        <nav class="flex items-center space-x-8">
          <button
            *ngFor="let item of navItems"
            (click)="onNavItemClick($event, item)"
            class="flex items-center gap-2 py-4 text-sm font-medium transition-colors relative"
            [ngClass]="{
              'hover:bg-primary-100 px-3 !py-2 rounded-lg': item.action === 'catalog',
              'bg-primary-100': item.action === 'catalog' && menu.isMenuOpen,
              'text-green-600': item.isActive && item.action !== 'catalog',
              'text-gray-700': !item.isActive && !item.isSpecial && item.action !== 'catalog',
              'text-red-500': item.isSpecial,
              'hover:text-green-600': !item.isSpecial && item.action !== 'catalog',
              'hover:text-red-600': item.isSpecial
            }">
            <i *ngIf="item.action == 'catalog'" class="pi pi-th-large"></i>

            <svg *ngIf="item.isSpecial" class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
              <path
                fill-rule="evenodd"
                d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03zM12.12 15.12A3 3 0 017 13s.879.5 2.5.5c0-1 .5-4 1.25-4.5.5 1 .786 1.293 1.371 1.879A2.99 2.99 0 0113 13a2.99 2.99 0 01-.879 2.121z"
                clip-rule="evenodd"></path>
            </svg>

            {{ item.title }}

            <!-- Dropdown Arrow for catalog -->
            <i *ngIf="item.action === 'catalog'" class="text-sm pi pi-chevron-down" [ngClass]="{ 'rotate-180': menu.isMenuOpen }"></i>

            <!-- Regular dropdown arrow -->
            <svg *ngIf="item.hasDropdown && item.action !== 'catalog'" class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
            </svg>
          </button>
        </nav>
      </div>
    </div>

    <!-- Mega Menu Component -->
    <app-mega-menu #menu></app-mega-menu>
  </div>
</header>

<nav class="mobile-nav hidden fixed -bottom-1 left-0 right-0 py-1 bg-white border-t border-gray-200 z-50">
  <div class="max-w-screen-2xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="flex items-center justify-between h-16">
      <ng-container *ngFor="let action of userActions">
        <button *ngIf="action.footer" (click)="onUserActionClick(action)" class="flex flex-col items-center gap-1 transition-colors group">
          <!-- Icon -->
          <div *ngIf="action.type == 'icon'" class="relative">
            <i class="{{ action.url }} text-lg text-gray-700 group-hover:text-primary-700"></i>
            <span *ngIf="action.count > 0" class="w-5 h-5 absolute -top-1 -right-3 bg-red-500 text-white text-xs rounded-full flex items-center justify-center">
              {{ action.count }}
            </span>
          </div>

          <!-- Image -->
          <div *ngIf="action.type == 'image'" class="relative mb-1">
            <img [src]="action.url" alt="{{ action.title }}" class="w-6 h-6 object-cover" />
            <span *ngIf="action.count > 0" class="w-5 h-5 absolute -top-1 -right-3 bg-red-500 text-white text-xs rounded-full flex items-center justify-center">
              {{ action.count }}
            </span>
          </div>

          <!-- Title -->
          <span class="text-xs text-gray-700 group-hover:text-primary-700">{{ action.title }}</span>
        </button>
      </ng-container>
    </div>
  </div>
</nav>

<p-drawer [(visible)]="isMenuOpen" position="left" styleClass="w-80 sm:w-96">
  <ng-template #header>
    <button (click)="onLogoClick()" class="h-[50px]">
      <img src="/assets/images/logo_green.png" alt="Logo" class="w-full h-full object-cover" />
    </button>
  </ng-template>

  <ng-template #content>
    <div class="flex flex-col gap-4 p-4">
      <ng-container *ngFor="let action of userActions">
        <button *ngIf="action.hamburger" (click)="onUserActionClick(action); toggleMenu()" class="flex items-center gap-6 hover:bg-gray-100 transition-colors">
          <!-- Icon -->
          <div *ngIf="action.type == 'icon'" class="relative">
            <i class="{{ action.url }} text-2xl text-gray-700"></i>
          </div>

          <!-- Image -->
          <div *ngIf="action.type == 'image'" class="relative mb-1">
            <img [src]="action.url" alt="{{ action.title }}" class="w-6 h-6 object-cover" />
          </div>

          <!-- Title -->
          <span class="text-base font-medium text-gray-700">{{ action.title }}</span>
        </button>
      </ng-container>
    </div>
  </ng-template>
</p-drawer>
